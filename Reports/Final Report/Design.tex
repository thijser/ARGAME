\chapter{Design} \label{cha:design}
	This chapter explains the design of the system. This includes: back-end
	design, model/graphical design, and main activities.

	\section{Main activities} \label{sec:mainactivities}
		There are several main activities in the system, corresponding to the two
		main user types of the system. These user types are both the physically co-
		located	players as well as the physically remote players. The activities
		are as follows:

		\subsection{A local user wants to start a game} \label{ssec:userstartgame}
			The local user ensures the main camera is set up according to the 
			provided guidelines. The local user then starts the server on the 
			machine the camera is connected to. The local user needs to take note 
			of the IP address of the server machine and fill this into his local 
			machine (to which the Meta One glasses are attached). The other players
			also fill in the same IP address. The server can also run on one of the 
			players' machines. The local user needs to wait for others to join the 
			game. When at least two local players and at least one remote player 
			has joined the game, the game will start.
			
		\subsection{A local user wants to join a game} \label{ssec:localjoingame}
			A local player wants to join an active game. Before this can
			happen, a game has to be started first. The local player needs to 
			acquire the IP address of the server machine and fill this in.
			Once the game starts, the local player will see virtual objects projected 
			through the Meta One glasses.

		\subsection{A remote user wants to join a game} \label{ssec:remotejoingame}
			A physically remote player wants to join an active game. Before this can
			happen, a game has to be started first. The remote user needs to acquire 
			the IP address of the local server machine (see \ref{ssec:userstartgame})
			and fill this in. The remote user will see a virtualized version of the 
			same game world as the local players.

	\section{Back-end design} \label{sec:backenddesign}
		The system is composed of three main parts: The Laser mechanics, the network
		functionality and the projection to 3D glasses. For this purpose, we divided
		the C\# code over three namespaces, named "Core", "Network" and
		"Projection", respectively.

		The "Core" namespace is responsible for drawing the Laser beams and
		providing the interactions of laser beams with the other game objects.
		The layout of this namespace is discussed in paragraph 
		\ref{ssec:corenamespace}.

		The "Network" namespace is responsible for synchronizing the game state
		between all connected players. The layout of this namespace if discussed 
		in paragraph \ref{ssec:networknamespace}.

		The "Projection" namespace is responsible for providing the projection to
		the VR glasses. This namespace provides the functionality required to project
		the game world to the VR glasses. The layout of this namespace is discusses in
		paragraph \ref{ssec:projectionnamespace}.
		
		Additionally, the game depends on the deployment of a server application written
		in C++. The purpose of this server application will be discussed in
		\ref{ssec:networknamespace}.
		
		\subsection{The Core namespace} \label{ssec:corenamespace}
			%TODO: Write about core namespace.
			
		\subsection{The Network namespace} \label{ssec:networknamespace}
			%TODO: Write about network namespace.
					
		\subsection{The Projection namespace} \label{ssec:projectionnamespace}
			%TODO: Write about projection namespace.

	\section{Game elements} \label{sec:graphicaldesign}
		For designing the 3D models, we used Blender. Blender is a free application
		for 3D modeling, under the GPL license, and Unity natively support Blender models (provided Blender is installed on the system). We have chosen for a light looking style featuring nature inspired modeling and gold and crystal based materials. The light modeling style causes slight miss alignments with the ground to be less noticeable and makes the lack of feedback from moving a card feel less odd. The crystals and gold 
		just feels good in combination with the beams of light.
		The following sections display and describe the graphics used in
		the gameplay elements, as well as the function of
		these elements.
		% TODO Explain why we chose this graphics style
		
		\subsection{Laser target} \label{ssec:lasertarget}
			The laser target is the main target of the game. It consists of
			a small container, which contains a crystal. The point of the
			game is to direct a laser beam from an emitter to this target.
			When the target is hit by a laser beam, the outer columns around
			the crystal inside will rotate and spread out, indicating that
			the target has been hit. The game will then proceed to the
			next level. An image of the target is shown in figure 
			\ref{fig:target}.
			\begin{figure}[h]
				\centering
				\includegraphics[width=\textwidth]{Target}
				\caption{the target of the game. The gold columns around the inner crystal will open up and rotate once the target is hit, as described earlier. Also, the crystal will change color once the target hits it.}
				\label{fig:target}
			\end{figure}
			
		\subsection{Mirror} \label{ssec:mirror}
			A mirror is a crucial game element. Its reflective surfaces
			allow it to reflect any laser beam that hits these surfaces.
			It is also the only element that players can move and/or rotate.
			All levels require at least one mirror to move or rotate
			in order to hit the target. An image of a mirror in-game is shown
			in \ref{fig:mirror}.
			\begin{figure}[h]
				\centering
				\includegraphics[width=\textwidth]{Mirror}
				\caption{an image of a mirror in-game, with its reflective surfaces.
				The light blue circles reflect laser beams, the golden outer frame
				does not.}
				\label{fig:mirror}
			\end{figure}
			
		\subsection{Wall} \label{ssec:wall}
			The wall is the main obstacle in the game. It blocks incoming
			laser beams completely. Walls are used in levels to make it 
			less easy for one player to reflect a laser beam coming from
			an emitter to the target. The first few levels mainly use walls
			to create paths that the laser beam has to go through, later
			levels use not only walls, but also other game objects. A wall
			is shown in \ref{fig:wall}
			\begin{figure}[h]
				\centering
				\includegraphics[width=\textwidth]{Wall}
				\caption{an image of a wall in-game. It blocks lasers entirely.}
				\label{fig:wall}
			\end{figure}
			
		\subsection{Emitter} \label{ssec:emitter}
			The emitter is the most important aspect of the entire game.
			It is the only "true" source of a laser beam (although game
			elements like the beam splitter can also create beams, these
			elements always require input in the form of another laser
			beam; the emitter does not have that problem, hence it is a "true"
			source). In the early levels, players only move and rotate mirrors
			to guide a laser beam from the emitter to the target, while in the
			later levels beams have to be guided towards other game elements
			(like the beam splitter, for example) in order to complete the
			level. It is possible to have multiple emitters in a single level,
			and later levels use this to create more complex puzzles.
			What the emitter looks like exactly is shown in figure 
			\ref{fig:emitter}.
			\begin{figure}[h]
				\centering
				\includegraphics[width=\textwidth]{Emitter}
				\caption{what the emitter looks like in the game. Also shown here is a laser beam
				coming from the emitter. The laser beam is colored red per standard. There are game objects that can change the coloring of the beam, these will also be described in this part of the report.}
				\label{fig:emitter}
			\end{figure}
			
		\subsection{Elevator} \label{ssec:elevator}
			The elevator is a game object that uses mirrors to elevate laser beams
			to a new height. This then allows laser beams to pass over walls that 
			stand on the ground. Therefore, elevators can function as a bridge over
			walls. An elevator is depicted in \ref{fig:elevator}.
			\begin{figure}[h]
				\centering
				\includegraphics[width=\textwidth]{Elevator}
				\caption{an elevator in-game. Both the upper and lower plate have a
				mirror (represented on the bottom plate as a light blue plate),
				which reflects laser beams.}
				\label{fig:elevator}
			\end{figure}
		\subsection{Portal}
		\subsection{Lens splitter}